pkgname=libraptorq
pkgver=0.1.6
pkgrel=1
pkgdesc='Forward error correction library implementing RaptorQ algorithm'
arch=(i686 x86_64)
url='https://www.fenrirproject.org'
license=(LGPL3)
makedepends=(cmake lz4)
source=(
	"https://www.fenrirproject.org/Luker/libRaptorQ/repository/archive.tar.gz?ref=v${pkgver}"
	cmake.patch
)
sha256sums=(
	a05c1273b6119577bcbf0e72ef414a6e07f31c9b0a7513bbff84e9dc8db7dd7d
	ce8d8805dbee0e686c21be7e009bba74f48e6001d5bb0124e9bc54833fb2da9b
)

build() {
	[[ -e "$srcdir/$pkgname-$pkgver" ]] || {
		mv "$srcdir/libRaptorQ-v$pkgver"-* "$srcdir/$pkgname-$pkgver"
		pushd "$srcdir/$pkgname-$pkgver"
		patch -p1 < ../cmake.patch
		popd
	}
	cd "$srcdir/$pkgname-$pkgver"
	mkdir -p build
	cd build
	cmake -D CMAKE_INSTALL_PREFIX=/usr -D CMAKE_BUILD_TYPE=Release ../
	make
}

package() {
	cd "$srcdir/$pkgname-$pkgver/build"
	make install DESTDIR=${pkgdir}
}
